<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BioSynth Planet v3</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');
  body, html { margin:0; padding:0; overflow:hidden; font-family:'Jua',sans-serif; background:#000; }
  
  canvas { display:block; }

  .hud {
    position:absolute; top:15px; right:20px;
    background: rgba(0,0,0,0.4); border:2px solid #00f5a0; border-radius:10px;
    padding:10px 20px; text-align:right; font-size:20px; z-index:10;
  }

  .bottom-bar {
    position:absolute; bottom:15px; left:50%; transform:translateX(-50%);
    display:flex; gap:20px; z-index:10;
  }

  .btn { background:#00f5a0; border:none; border-radius:20px; padding:10px 25px; font-size:18px; color:#000; cursor:pointer; transition:0.3s; }
  .btn:hover { background:#a1ffd1; }

  .window {
    position:absolute; top:50%; left:50%; width:400px; height:450px;
    background: rgba(20,20,30,0.95); border:3px solid #00f5a0; border-radius:15px;
    transform:translate(-50%, -50%); display:none; flex-direction:column; padding:15px; overflow-y:auto; z-index:20;
  }

  .window h2 { text-align:center; color:#00f5a0; }
  .item { background: rgba(255,255,255,0.1); margin:5px 0; padding:10px; border-radius:10px; cursor:pointer; }
  .item:hover { background: rgba(0,245,160,0.3); }
  .close-btn { background:#ff77aa; color:#fff; border:none; border-radius:15px; padding:5px 10px; cursor:pointer; align-self:flex-end; }

  input[type="file"], select { background:#222; border:1px solid #00f5a0; color:white; border-radius:5px; padding:5px; }

  #certList .record { background: rgba(255,255,255,0.1); margin:5px 0; padding:8px; border-radius:5px; }
</style>
</head>
<body>

<div class="hud">
  ğŸŒ± í¬ì¸íŠ¸: <span id="points">1200</span><br>
  ğŸŒ í™˜ê²½ ì ìˆ˜: <span id="eco">320</span>
</div>

<div class="bottom-bar">
  <button class="btn" onclick="openShop()">ìƒì </button>
  <button class="btn" onclick="openCert()">ì¸ì¦</button>
</div>

<!-- ìƒì  ì°½ -->
<div id="shopWindow" class="window">
  <button class="close-btn" onclick="closeShop()">ë‹«ê¸°</button>
  <h2>ğŸŒ¿ ìƒì </h2>
  <label>ì¹´í…Œê³ ë¦¬:
    <select id="shopCategory" onchange="updateShopItems()">
      <option value="plant">ì‹ë¬¼ ê¾¸ë¯¸ê¸°</option>
      <option value="animal">ë™ë¬¼ ì´ì£¼</option>
      <option value="tool">ì •í™” ì¥ë¹„</option>
      <option value="package">ìœ ë£Œ íŒ¨í‚¤ì§€</option>
    </select>
  </label>
  <div id="shopItems"></div>
</div>

<!-- ì¸ì¦ ì°½ -->
<div id="certWindow" class="window">
  <button class="close-btn" onclick="closeCert()">ë‹«ê¸°</button>
  <h2>ğŸ“· í™˜ê²½ ì‹¤ì²œ ì¸ì¦</h2>
  <form id="certForm">
    <label>ì¹´í…Œê³ ë¦¬:
      <select id="category">
        <option>ë¶„ë¦¬ë°°ì¶œ</option>
        <option>ëŒ€ì¤‘êµí†µ ì´ìš©</option>
        <option>ì¹œí™˜ê²½ í™”í•™ ì‹¤í—˜</option>
        <option>ìƒí™”í•™ ì •í™” ì‹¤í—˜</option>
      </select>
    </label><br><br>
    <label>ì‚¬ì§„ ì—…ë¡œë“œ:
      <input type="file" id="photo" accept="image/*">
    </label><br><br>
    <button class="btn" type="submit">ì¸ì¦í•˜ê¸°</button>
  </form>
  <hr>
  <h3>ğŸ“œ ì¸ì¦ ê¸°ë¡</h3>
  <div id="certList"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.156.0/build/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.156.0/examples/js/controls/OrbitControls.js"></script>
<script>
// ================== 3D í–‰ì„± ===================
let scene = new THREE.Scene();
let camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
let renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// ì¡°ëª…
scene.add(new THREE.AmbientLight(0xffffff, 0.6));
let point = new THREE.PointLight(0xffffff, 1);
point.position.set(5,5,5);
scene.add(point);

// í–‰ì„±
let texLoader = new THREE.TextureLoader();
let texture = texLoader.load('https://threejsfundamentals.org/threejs/resources/images/planets/earth_atmos_2048.jpg'); // ì•ˆì • í…ìŠ¤ì²˜
let planetGeo = new THREE.SphereGeometry(3, 64, 64);
let planetMat = new THREE.MeshStandardMaterial({map: texture});
let planet = new THREE.Mesh(planetGeo, planetMat);
scene.add(planet);

// ì—°êµ¬ì†Œ
let labGeo = new THREE.BoxGeometry(0.3, 0.3, 0.3);
let labMat = new THREE.MeshStandardMaterial({color: 0x00f5a0});
let lab = new THREE.Mesh(labGeo, labMat);
lab.position.set(0, 3.3, 0);
scene.add(lab);

let controls = new THREE.OrbitControls(camera, renderer.domElement);
camera.position.z = 7;

function animate() {
  requestAnimationFrame(animate);
  planet.rotation.y += 0.002;
  renderer.render(scene, camera);
}
animate();

// ================== ìƒì  ===================
const shopItemsDiv = document.getElementById("shopItems");

const shopData = {
  plant: [
    {name:"ğŸŒ· íŠ¤ë¦½", price:150},
    {name:"ğŸŒ³ ë‚˜ë¬´", price:200},
    {name:"ğŸŒ» í•´ë°”ë¼ê¸°", price:250}
  ],
  animal: [
    {name:"ğŸ° í† ë¼ (ì¼ë°˜)", price:500},
    {name:"ğŸ¦Š ì—¬ìš° (ì¼ë°˜)", price:600},
    {name:"ğŸ¦„ ìœ ë‹ˆì½˜ (í¬ê·€)", price:1500},
    {name:"ğŸ¦‹ ë‚˜ë¹„ (í¬ê·€)", price:1200}
  ],
  tool: [
    {name:"ğŸ§ª ì •í™” ì¥ë¹„ A", price:300},
    {name:"ğŸ§ª ì •í™” ì¥ë¹„ B", price:450}
  ],
  package: [
    {name:"ğŸŒŸ ë©¸ì¢…ìœ„ê¸°ì¢… íŒ¨í‚¤ì§€", price:"ìœ ë£Œ"}
  ]
};

function updateShopItems(){
  const cat = document.getElementById("shopCategory").value;
  shopItemsDiv.innerHTML = "";
  shopData[cat].forEach(item=>{
    let div = document.createElement("div");
    div.className = "item";
    div.textContent = `${item.name} - ${item.price}P`;
    div.onclick = ()=>{
      if(item.price==="ìœ ë£Œ"){
        alert("ìœ ë£Œ íŒ¨í‚¤ì§€ëŠ” ê²°ì œê°€ í•„ìš”í•©ë‹ˆë‹¤!");
      } else {
        let points = parseInt(document.getElementById("points").textContent);
        if(points >= item.price){
          document.getElementById("points").textContent = points-item.price;
          alert(item.name+" êµ¬ë§¤ ì™„ë£Œ!");
        } else { alert("í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!"); }
      }
    }
    shopItemsDiv.appendChild(div);
  });
}

function openShop(){ document.getElementById("shopWindow").style.display="flex"; updateShopItems(); }
function closeShop(){ document.getElementById("shopWindow").style.display="none"; }

// ================== ì¸ì¦ ===================
function openCert(){ document.getElementById("certWindow").style.display="flex"; }
function closeCert(){ document.getElementById("certWindow").style.display="none"; }

const form = document.getElementById("certForm");
const list = document.getElementById("certList");
form.addEventListener("submit", (e)=>{
  e.preventDefault();
  const file = document.getElementById("photo").files[0];
  if(!file){
    alert("ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì•¼ ì¸ì¦ë©ë‹ˆë‹¤!");
    return;
  }
  const cat = document.getElementById("category").value;
  const date = new Date();
  const record = document.createElement("div");
  record.className = "record";
  record.textContent = `${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()} | ${cat}`;
  list.prepend(record);
  // í¬ì¸íŠ¸ ì¶”ê°€
  let points = parseInt(document.getElementById("points").textContent);
  document.getElementById("points").textContent = points+100; // ì¸ì¦ 100P
  alert("ì¸ì¦ ì™„ë£Œ! +100P íšë“");
  form.reset();
});
</script>

</body>
</html>
